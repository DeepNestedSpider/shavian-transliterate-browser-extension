import { describe, it, expect, beforeAll } from 'bun:test';
import { TransliterationEngineFactory } from '../src/core/transliterationEngine';

const input = `Towards the end of 1962, the Cuban Missile Crisis had just ended, it was still a year-and-a-day until the first episode of Doctor Who would air, and a remarkable book was published. It was not the content of the book that was so astonishing; Bernard Shawâ€™s play Androcles and the Lion was fifty years old by this stage. This edition of Androcles and the Lion witnessed the birth of an entirely new alphabet, and its publication was a close-run thing. The Shaw alphabet, which came to be more commonly known by the latinised name of â€œShavianâ€, represented the culmination of a lifetime of advocacy by Irish playwright, writer and wit, Bernard Shaw. It was perhaps the subject on which Shaw wrote most earnestly, oftenâ€”but not alwaysâ€”casting aside his love of levity to argue on purely rational grounds about the economic inefficiencies of silent letters and absurd spellings, and the failure of traditional orthography to offer any instruction to children (or adults, for that matter) on how to speak English. G K Chesterton wrote with typical caustic wit that Shaw â€œfound himself, led by theâ€¦mad imp of modernity, on the side of the people who want to have phonetic spellingâ€, and â€œpleasantly surprised innumerable cranks and revolutionists by finding quite rational arguments for themâ€.`;

const expected = `ð‘‘ð‘©ð‘¢ð‘¹ð‘›ð‘Ÿ ð‘ž ð‘§ð‘¯ð‘› ð‘ 1962, ð‘ž Â·ð‘’ð‘¿ð‘šð‘©ð‘¯ ð‘¥ð‘¦ð‘•ð‘²ð‘¤ ð‘’ð‘®ð‘²ð‘•ð‘¦ð‘• ð‘£ð‘¨ð‘› ð‘¡ð‘³ð‘•ð‘‘ ð‘§ð‘¯ð‘›ð‘©ð‘›, ð‘¦ð‘‘ ð‘¢ð‘ªð‘Ÿ ð‘•ð‘‘ð‘¦ð‘¤ ð‘© ð‘˜ð‘½-ð‘¯-ð‘©-ð‘›ð‘± ð‘©ð‘¯ð‘‘ð‘¦ð‘¤ ð‘ž ð‘“ð‘»ð‘•ð‘‘ ð‘§ð‘ð‘¦ð‘•ð‘´ð‘› ð‘ â€¹Â·ð‘›ð‘ªð‘’ð‘‘ð‘¼ ð‘£ð‘µâ€º ð‘¢ð‘«ð‘› ð‘º, ð‘¯ ð‘© ð‘®ð‘¦ð‘¥ð‘¸ð‘’ð‘©ð‘šð‘©ð‘¤ ð‘šð‘«ð‘’ ð‘¢ð‘ªð‘Ÿ ð‘ð‘³ð‘šð‘¤ð‘¦ð‘–ð‘‘. ð‘¦ð‘‘ ð‘¢ð‘ªð‘Ÿ ð‘¯ð‘ªð‘‘ ð‘ž ð‘’ð‘ªð‘¯ð‘‘ð‘§ð‘¯ð‘‘ ð‘ ð‘ž ð‘šð‘«ð‘’ ð‘žð‘¨ð‘‘ ð‘¢ð‘ªð‘Ÿ ð‘•ð‘´ ð‘©ð‘•ð‘‘ð‘ªð‘¯ð‘¦ð‘–ð‘¦ð‘™; Â·ð‘šð‘»ð‘¯ð‘¼ð‘› ð‘–ð‘·ð‘Ÿ ð‘ð‘¤ð‘± â€¹Â·ð‘¨ð‘¯ð‘›ð‘®ð‘©ð‘’ð‘¤ð‘°ð‘Ÿ ð‘¯ ð‘ž ð‘¤ð‘²ð‘©ð‘¯â€º ð‘¢ð‘ªð‘Ÿ ð‘“ð‘¦ð‘“ð‘‘ð‘¦ ð‘˜ð‘½ð‘Ÿ ð‘´ð‘¤ð‘› ð‘šð‘² ð‘žð‘¦ð‘• ð‘•ð‘‘ð‘±ð‘¡. ð‘žð‘¦ð‘• ð‘¦ð‘›ð‘¦ð‘–ð‘©ð‘¯ ð‘ Â·ð‘¨ð‘¯ð‘›ð‘®ð‘©ð‘’ð‘¤ð‘°ð‘Ÿ ð‘¯ ð‘ž ð‘¤ð‘²ð‘©ð‘¯ ð‘¢ð‘¦ð‘‘ð‘¯ð‘©ð‘•ð‘‘ ð‘ž ð‘šð‘»ð‘” ð‘ ð‘©ð‘¯ ð‘¦ð‘¯ð‘‘ð‘²ð‘¼ð‘¤ð‘¦ ð‘¯ð‘¿ ð‘¨ð‘¤ð‘“ð‘©ð‘šð‘§ð‘‘, ð‘¯ ð‘¦ð‘‘ð‘• ð‘ð‘³ð‘šð‘¤ð‘¦ð‘’ð‘±ð‘–ð‘©ð‘¯ ð‘¢ð‘ªð‘Ÿ ð‘© ð‘’ð‘¤ð‘´ð‘•-ð‘®ð‘³ð‘¯ ð‘”ð‘¦ð‘™.\n\nð‘ž Â·ð‘–ð‘· ð‘¨ð‘¤ð‘“ð‘©ð‘šð‘§ð‘‘, ð‘¢ð‘¦ð‘— ð‘’ð‘±ð‘¥ ð‘‘ ð‘šð‘° ð‘¥ð‘¹ ð‘’ð‘ªð‘¥ð‘©ð‘¯ð‘¤ð‘¦ ð‘¯ð‘´ð‘¯ ð‘šð‘² ð‘ž ð‘¤ð‘¨ð‘‘ð‘¦ð‘¯ð‘²ð‘Ÿð‘› ð‘¯ð‘±ð‘¥ ð‘ Â·ð‘–ð‘±ð‘ð‘¾ð‘¯, ð‘®ð‘§ð‘ð‘®ð‘¦ð‘Ÿð‘§ð‘¯ð‘‘ð‘©ð‘› ð‘ž ð‘’ð‘³ð‘¤ð‘¥ð‘¦ð‘¯ð‘±ð‘–ð‘©ð‘¯ ð‘ ð‘© ð‘¤ð‘²ð‘“ð‘‘ð‘²ð‘¥ ð‘ ð‘¨ð‘›ð‘ð‘©ð‘’ð‘©ð‘•ð‘¦ ð‘šð‘² ð‘²ð‘®ð‘¦ð‘– ð‘ð‘¤ð‘±ð‘®ð‘²ð‘‘, ð‘®ð‘²ð‘‘ð‘¼ ð‘¯ ð‘¢ð‘¦ð‘‘, Â·ð‘šð‘»ð‘¯ð‘¼ð‘› ð‘–ð‘·. ð‘¦ð‘‘ ð‘¢ð‘ªð‘Ÿ ð‘ð‘¼ð‘£ð‘¨ð‘ð‘• ð‘ž ð‘•ð‘³ð‘šð‘¡ð‘§ð‘’ð‘‘ ð‘ªð‘¯ ð‘¢ð‘¦ð‘— Â·ð‘–ð‘· ð‘®ð‘´ð‘‘ ð‘¥ð‘´ð‘•ð‘‘ ð‘»ð‘¯ð‘©ð‘•ð‘‘ð‘¤ð‘¦, ð‘ªð‘“ð‘©ð‘¯â€”ð‘šð‘³ð‘‘ ð‘¯ð‘ªð‘‘ ð‘·ð‘¤ð‘¢ð‘±ð‘Ÿâ€”ð‘’ð‘­ð‘•ð‘‘ð‘¦ð‘™ ð‘©ð‘•ð‘²ð‘› ð‘£ð‘¦ð‘Ÿ ð‘¤ð‘³ð‘ ð‘ ð‘¤ð‘§ð‘ð‘¦ð‘‘ð‘¦ ð‘‘ ð‘¸ð‘œð‘¿ ð‘ªð‘¯ ð‘ð‘˜ð‘«ð‘¼ð‘¤ð‘¦ ð‘®ð‘¨ð‘–ð‘©ð‘¯ð‘©ð‘¤ ð‘œð‘®ð‘¬ð‘¯ð‘›ð‘Ÿ ð‘©ð‘šð‘¬ð‘‘ ð‘ž ð‘°ð‘’ð‘©ð‘¯ð‘ªð‘¥ð‘¦ð‘’ ð‘¦ð‘¯ð‘¦ð‘“ð‘¦ð‘–ð‘©ð‘¯ð‘•ð‘¦ð‘Ÿ ð‘ ð‘•ð‘²ð‘¤ð‘©ð‘¯ð‘‘ ð‘¤ð‘§ð‘‘ð‘¼ð‘Ÿ ð‘¯ ð‘©ð‘šð‘•ð‘»ð‘› ð‘•ð‘ð‘§ð‘¤ð‘¦ð‘™ð‘Ÿ, ð‘¯ ð‘ž ð‘“ð‘±ð‘¤ð‘˜ð‘¼ ð‘ ð‘‘ð‘®ð‘©ð‘›ð‘¦ð‘–ð‘©ð‘¯ð‘©ð‘¤ ð‘¹ð‘”ð‘ªð‘œð‘®ð‘©ð‘“ð‘¦ ð‘‘ ð‘ªð‘“ð‘¼ ð‘§ð‘¯ð‘¦ ð‘¦ð‘¯ð‘•ð‘‘ð‘®ð‘³ð‘’ð‘–ð‘©ð‘¯ ð‘‘ ð‘—ð‘¦ð‘¤ð‘›ð‘®ð‘©ð‘¯ (ð‘¹ ð‘¨ð‘›ð‘³ð‘¤ð‘‘ð‘•, ð‘“ ð‘žð‘¨ð‘‘ ð‘¥ð‘¨ð‘‘ð‘¼) ð‘ªð‘¯ ð‘£ð‘¬ ð‘‘ ð‘•ð‘ð‘°ð‘’ ð‘¦ð‘™ð‘œð‘¤ð‘¦ð‘–. Â·ð‘œ. ð‘’. ð‘—ð‘§ð‘•ð‘‘ð‘¼ð‘‘ð‘©ð‘¯ ð‘®ð‘´ð‘‘ ð‘¢ð‘¦ð‘ž ð‘‘ð‘¦ð‘ð‘¦ð‘’ð‘©ð‘¤ ð‘’ð‘·ð‘•ð‘‘ð‘¦ð‘’ ð‘¢ð‘¦ð‘‘ ð‘žð‘¨ð‘‘ Â·ð‘–ð‘· â€¹ð‘“ð‘¬ð‘¯ð‘› ð‘£ð‘¦ð‘¥ð‘•ð‘§ð‘¤ð‘“, ð‘¤ð‘§ð‘› ð‘šð‘² ð‘žâ€¦ð‘¥ð‘¨ð‘› ð‘¦ð‘¥ð‘ ð‘ ð‘¥ð‘©ð‘›ð‘»ð‘¯ð‘¦ð‘‘ð‘¦, ð‘ªð‘¯ ð‘ž ð‘•ð‘²ð‘› ð‘ ð‘ž ð‘ð‘°ð‘ð‘©ð‘¤ ð‘£ð‘µ ð‘¢ð‘ªð‘¯ð‘‘ ð‘‘ ð‘£ð‘¨ð‘ ð‘“ð‘©ð‘¯ð‘§ð‘‘ð‘¦ð‘’ ð‘•ð‘ð‘§ð‘¤ð‘¦ð‘™â€º, ð‘¯ â€¹ð‘ð‘¤ð‘§ð‘Ÿð‘©ð‘¯ð‘‘ð‘¤ð‘¦ ð‘•ð‘¼ð‘ð‘®ð‘²ð‘Ÿð‘› ð‘¦ð‘¯ð‘¿ð‘¥ð‘¼ð‘©ð‘šð‘©ð‘¤ ð‘’ð‘®ð‘¨ð‘™ð‘’ð‘• ð‘¯ ð‘®ð‘§ð‘ð‘©ð‘¤ð‘µð‘–ð‘©ð‘¯ð‘¦ð‘•ð‘‘ð‘• ð‘šð‘² ð‘“ð‘²ð‘¯ð‘›ð‘¦ð‘™ ð‘’ð‘¢ð‘²ð‘‘ ð‘®ð‘¨ð‘–ð‘©ð‘¯ð‘©ð‘¤ ð‘¸ð‘œð‘¿ð‘¥ð‘©ð‘¯ð‘‘ð‘• ð‘“ ð‘žð‘§ð‘¥â€º.`;

describe('Dechifro Engine - Shavian Transliteration', () => {
  let engine: any;

  beforeAll(async () => {
    engine = await TransliterationEngineFactory.createEngine('dechifro');
  });

  it('should correctly transliterate the provided text sample', () => {
    const result = engine.transliterate(input);
    if (result !== expected) {
      // Write the actual result to a file for easier diffing
      require('fs').writeFileSync('dechifro-actual.txt', result, 'utf8');
    }
    expect(result).toBe(expected);
  });
});
